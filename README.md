# Portfolio Optimization — End-to-End Quant Workflow (Tasks 1–5)

This repository contains a complete, **script-first quantitative finance pipeline** that:

1. Fetches market data  
2. Performs EDA and return/risk analysis  
3. Forecasts TSLA (ARIMA/SARIMA vs LSTM)  
4. Builds optimized portfolios from forecasts  
5. Backtests portfolio strategies against a benchmark  

> **Official submission outputs are the script-generated artifacts under `outputs/`**  
> (Notebook cell outputs are not considered official deliverables.)

---

## Project Layout

`.
├─ .github/
│  └─ workflows/
│     └─ unittests.yml
├─ notebooks/
│  ├─ task1.ipynb
│  ├─ task2.ipynb
│  ├─ task3_Forecast_Future_Market_Trends.ipynb
│  ├─ task4_Optimize_Portfolio_Based_on_Forecast.ipynb
│  └─ task5_Strategy_Backtesting.ipynb
├─ scripts/
│  ├─ 01_fetch_data.py
│  ├─ 02_make_returns_and_task1_tables.py
│  ├─ 02_task1_scale_and_viz.py
│  ├─ 03_task2_make_tsla_splits_and_features.py
│  ├─ 04_task2_train_arima.py
│  ├─ 05_task2_train_lstm.py
│  ├─ 06_task2_compare_models.py
│  ├─ 07_task2_run_all.py
│  ├─ task3_analyze_trends.py
│  ├─ task3_generate_forecast.py
│  ├─ task3_plot_forecast.py
│  ├─ task3_run_all.py
│  ├─ task4_optimize_portfolio.py
│  └─ task5_backtest.py
├─ src/                # Reusable modules used by scripts
├─ data/
│  ├─ task1/
│  └─ task2/
├─ outputs/
│  ├─ task1/
│  ├─ task2/
│  ├─ task3/
│  ├─ task4/
│  └─ task5/
├─ requirements.txt
└─ README.md

## Quickstart

1) Create environment & install dependencies
python -m venv .venv

### Windows

.venv\Scripts\activate

### macOS / Linux

source .venv/bin/activate
python -m pip install --upgrade pip
pip install -r requirements.txt
2) Run the full workflow (recommended)
Run scripts in order:

python scripts/01_fetch_data.py
python scripts/02_make_returns_and_task1_tables.py
python scripts/02_task1_scale_and_viz.py

python scripts/07_task2_run_all.py

python scripts/task3_run_all.py
python scripts/task4_optimize_portfolio.py
python scripts/task5_backtest.py

## Task 1 — Data, Returns, and EDA

Goal
Fetch price data and compute returns
Produce summary tables and visualizations for exploratory analysis
Understand risk/return characteristics

### Primary scripts

scripts/01_fetch_data.py
scripts/02_make_returns_and_task1_tables.py
scripts/02_task1_scale_and_viz.py

### Outputs

Written under outputs/task1/ (tables and figures generated by scripts)

## Task 2 — TSLA Forecasting (ARIMA/SARIMA vs LSTM)

Goal
Forecast TSLA adj_close using:
Classical models: ARIMA / SARIMA
Deep learning: LSTM (multivariate features)
Align predictions to test dates
Evaluate using MAE, RMSE, and MAPE

### How Task 2 runs

- One-command runner
python scripts/07_task2_run_all.py
- Or step-by-step
python scripts/03_task2_make_tsla_splits_and_features.py
python scripts/04_task2_train_arima.py
python scripts/05_task2_train_lstm.py
python scripts/06_task2_compare_models.py

### Deliverables checklist (Task 2)

✅ Splits & features
data/task2/splits/tsla_train.parquet
data/task2/splits/tsla_test.parquet
data/task2/features/tsla_features_train.parquet
data/task2/features/tsla_features_test.parquet

✅ Model artifacts
outputs/task2/models/lstm_model.keras
(optional) outputs/task2/models/arima_model.pkl

✅ Forecasts (aligned to test dates)
outputs/task2/forecasts/tsla_arima_forecast.csv
outputs/task2/forecasts/tsla_lstm_forecast.csv
outputs/task2/forecasts/tsla_forecasts_merged.csv

✅ Metrics & documentation
outputs/task2/metrics/model_comparison.csv ✅ required
outputs/task2/metrics/arima_params.json
outputs/task2/metrics/lstm_architecture.json
Required metrics table (Task 2)
The required deliverable is:

- outputs/task2/metrics/model_comparison.csv
- must include at least:
Model name
MAE
RMSE
MAPE (%)

## Task 3 — Forecast Future Market Trends

- Goal
Produce forward-looking market trend forecasts (6–12 months)
Generate forecast plots and confidence intervals (where applicable)
- Primary scripts
scripts/task3_analyze_trends.py
scripts/task3_generate_forecast.py
scripts/task3_plot_forecast.py
scripts/task3_run_all.py (recommended entry point)
- Outputs
Written under outputs/task3/

## Task 4 — Optimize Portfolio Based on Forecast

- Goal
Use expected returns and covariance assumptions
Incorporate forecast outputs where applicable
Construct optimized portfolios (e.g., min-vol, max-Sharpe)
- Primary script
scripts/task4_optimize_portfolio.py

- Outputs
Written under outputs/task4/

## Task 5 — Strategy Backtesting

- Goal
Backtest the portfolio strategy from Task 4
Compare against a benchmark (e.g., 60/40 SPY/BND or project-defined baseline)
- Report performance metrics:
Returns
Volatility
Drawdowns
Turnover
- Primary script
scripts/task5_backtest.py
- Outputs
Written under outputs/task5/
Notebooks (Exploration / Presentation)

## Notebooks mirror the workflow for explanation and visualization

notebooks/task1.ipynb
notebooks/task2.ipynb
notebooks/task3_Forecast_Future_Market_Trends.ipynb
notebooks/task4_Optimize_Portfolio_Based_on_Forecast.ipynb
notebooks/task5_Strategy_Backtesting.ipynb

Training and official artifacts are generated by scripts.
Notebooks may load from outputs/*.

- CI (GitHub Actions)
Workflow file:
.github/workflows/unittests.yml
If running a Python version matrix (e.g., 3.10 and 3.11), keep requirements.txt compatible using environment markers when needed.

Example:

package==x.y.z ; python_version < "3.11"
package==a.b.c ; python_version >= "3.11"

## Troubleshooting

- Forecast alignment: Ensure model forecasts use the same test index before computing metrics.
- Data leakage: Splits must be chronological; feature engineering must not peek into the future.
- LSTM feature/target issues: If adj_close is missing, inspect:
- outputs/task2/metrics/lstm_architecture.json
- Feature creation in scripts/03_task2_make_tsla_splits_and_features.py

License
Educational / coursework use.
